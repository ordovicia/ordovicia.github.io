<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.29" />

  <title>Arch Linux on Raspberry Pi 2 - Initial Setup &middot; 外部記憶</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  

  

  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/ordovicia" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/ordovicia" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Arch Linux on Raspberry Pi 2 - Initial Setup</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10 Dec 2015</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="/tags/arch-linux">Arch Linux</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="/tags/raspberry-pi">Raspberry Pi</a>
    
  </div>
  
  

</div>

  

<p>先日Raspberry Pi 2を買いました。
試してみたかったArch Linuxをインストールしてみたのでその作業を記録しておきます。</p>

<h1 id="arch-linuxのインストール">Arch Linuxのインストール</h1>

<p>Ubuntu15.04で、
<a href="http://archlinuxarm.org/platforms/armv7/broadcom/raspberry-pi-2">Arch Linux ARMのページ</a>
の通りに作業をおこなうと、なにも詰まらずにインストールができました。
ただし<code>fdisk, mkfs</code>などは<code>sudo</code>をつけて実行し、
<code>bsdtar</code>コマンドは新たにaptでインストールして実行しました。</p>

<p>インストールが済んだら、RasPi2に挿してLANケーブルをつなぎ、
電源ケーブルをつなぎます。</p>

<p>sshでrootユーザーとして入ろうとしたのですが、
なぜが初期パスワードのはずの&rsquo;root&rsquo;を入力しても&rsquo;Permission denied&rsquo;でした。
そこでalarmユーザーではいりました。
このユーザーの初期パスワードは&rsquo;alarm&rsquo;です。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="">Welcome to Arch Linux ARM
</span><span style="">
</span><span style="">     Website: http://archlinuxarm.org
</span><span style="">       Forum: http://archlinuxarm.org/forum
</span><span style="">         IRC: </span><span style="color:#75715e">#archlinux-arm on irc.Freenode.net
</span><span style="color:#75715e"></span><span style="">Last login: Wed Dec  </span><span style="color:#ae81ff">9</span><span style=""> </span><span style="color:#ae81ff">12</span><span style="">:54:36 </span><span style="color:#ae81ff">2015</span><span style=""> from </span><span style="color:#ae81ff">192</span><span style="">.168.0.4</span></code></pre>
</div>
<p>こんな出力がでたので成功のようです。</p>

<h1 id="初期セットアップ">初期セットアップ</h1>

<h2 id="更新">更新</h2>

<p><code>sudo</code>コマンドがなかったので、
<code>$ su</code>でrootになり（このときは&rsquo;root&rsquo;がパスワードでした）、
とりあえず</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="">$ pacman -Syu</span></code></pre>
</div>
<p>しました。
けっこう時間がかかります。</p>

<p>なお、この前に<code>/etc/pacman.d/mirrorlist</code>を編集して、
ミラーサーバーを近所の台湾あたりにしておくといいそうです。
<a href="http://qiita.com/masahixixi/items/97b40ff0e9d126b296bd#%E5%88%9D%E6%9C%9F%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97">参考：「Raspberry Pi に ArchARM をインストールする」 - Qiita</a></p>

<p>更新したら<code>$ reboot</code>しておきます。</p>

<h2 id="microsdカード">microSDカード</h2>

<p>microSDカードの容量が2GBまでしか認識されないとどこかで聞いた気がしたのですが、</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="">$ df -h</span></code></pre>
</div>
<p>で確認すると、本来の16GB近くの値が表示されていたので、
気にしないことにしました。
RasPi1だけの問題だったのでしょうか。</p>

<h2 id="パスワードの変更">パスワードの変更</h2>

<p>root, alarmユーザーともに、<code>$ passwd</code>でパスワードを変更しておきます。</p>

<h2 id="時刻合わせ">時刻合わせ</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="">$ timedatectl set-timezone Asia/Tokyo</span></code></pre>
</div>
<p>で、タイムゾーンを合わせます。
さらに</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="">$ timedatectl set-ntp true</span></code></pre>
</div>
<p>しておくと、時刻サーバーと同期がとれるようです。</p>

<h2 id="ipアドレスの固定">IPアドレスの固定</h2>

<p>しようとしましたが、うまく行きませんでした。
<a href="https://wiki.archlinuxjp.org/index.php/Netctl">netctl</a>をつかって設定したつもりでも、
設定したIPアドレスで接続できませんでした。
<code>$ ifconfig</code>を見るとinetが設定したIPアドレスになっているかと思ったら
rebootするとまた変わっていたりしました。
このとき、設定したネットワークの<code>$ netctl status</code>を見ると、
設定ファイルが読み込まれていないようでした。</p>

<p>また困ったら調べてみます。</p>

<h2 id="ホストネームの設定">ホストネームの設定</h2>

<p>ここからは<a href="http://ochaochaocha3.hateblo.jp/entry/2014/04/19/raspberry-pi-initial-setting-of-arch-linux-for-ssh-connecting">「Raspberry Pi: Arch Linux の初期設定（SSH 接続まで）」 - ochalog</a>を参考にしました。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="">$ hostnamectl set-hostname raspi</span></code></pre>
</div>
<p>これで<code>/etc/hostname</code>にホストネームが書き込まれます。</p>

<h2 id="sshでrootでのログインを禁止する">sshでrootでのログインを禁止する</h2>

<p><code>/etc/ssh/sshd_config</code>を開き、</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="">PermitRootLogin no</span></code></pre>
</div>
<p>と編集します。これでsshでrootでのログインを禁止できました。
（もともと何故かできなかったんですけどね。）</p>

<h2 id="sudoのインストール">sudoのインストール</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="">$ pacman -S sudo</span></code></pre>
</div>
<p>で<code>sudo</code>をインストールし、wheelグループが使えるように、
<code>$ visudo</code>を実行して</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="">%wheel </span><span style="">ALL</span><span style=""></span><span style="color:#f92672">=(</span><span style="">ALL</span><span style="color:#f92672">)</span><span style=""> ALL</span></code></pre>
</div>
<p>の部分のコメントアウトを解除しました。</p>

<h2 id="ユーザーの追加">ユーザーの追加</h2>

<p>ユーザーを追加し、パスワードを設定して、さらに<code>sudo</code>がつかえるように、
wheelグループに追加します。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="">$ useradd -m cyan
</span><span style="">$ passwd cyan
</span><span style="">$ gpasswd -a cyan wheel</span></code></pre>
</div>
<hr />

<p>これで初期セットアップが完了しました。
IPアドレスの固定はできていませんが、困ったらまた調べることにします。
ユーザーグループとかも何も知らないので、ぼちぼちArch LinuxのWikiを読んでみます。</p>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="/post/learningrust/ownership/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="/post/learningrust/ownership/">Learning Rust - Ownership</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="/post/archlinuxonraspi/devel_setup/">Arch Linux on Raspberry Pi 2 - Setup for Development</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="/post/archlinuxonraspi/devel_setup/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>


<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: { inlineMath: [['$','$'], ["\\(","\\)"]] }
  });
</script>
<script
    type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" />
</script>

